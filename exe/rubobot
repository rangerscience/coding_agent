#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require "ruby_llm"
require_relative "lib/agent"

RubyLLM.configure do |config|
  config.anthropic_api_key = ENV.fetch("ANTHROPIC_API_KEY", nil)
  config.default_model = "claude-3-7-sonnet"

  config.retry_interval = 60 # seconds
  config.retry_backoff_factor = 2
end

# Display help information if requested
if ARGV.empty? || ARGV.include?("--help") || ARGV.include?("-h")
  puts "Usage: rubobot \"Your prompt here\""
  puts ""
  puts "Options:"
  puts "  --help, -h    Show this help message"
  puts ""
  puts "Examples:"
  puts "  rubobot \"Check if my Gemfile has the latest version of Rails\""
  puts "  rubobot \"Add RSpec to my project\""
  exit 1
end

def read_file(path)
  File.exist?(path) ? File.read(path).strip : nil
end

puts __FILE__
puts __dir__

debugger
# read_file(File.join(".ai", "scratch", "prompt.txt")) || ARGV.join(" ")

# Create a new agent and process the prompt
# agent = Agent.new(working_dir: __dir__)
# response = agent.chat(prompt)
